var room = HBInit({ roomName: "âšªï¸âš« Arena Hx âš«âšªï¸", maxPlayers: 25, playerName : " Hx BOT ", public : true});
room.setDefaultStadium("Classic");
room.setScoreLimit(0);
room.setTimeLimit(0);
room.setTeamsLock(true);

let specoff = false;

// Se nÃ£o hÃ¡ admins dÃ¡ o admin para um dos jogadores restantes.
function updateAdmins() {
  // Lista todos os jogadores com exceÃ§Ã£o do host (ID = 0).
  var players = room.getPlayerList().filter((player) => player.id != 0 );
  if ( players.length == 0 ) return; // Nao hÃ¡ jogadores, nao faz nada.
  if ( players.find((player) => player.admin) != null ) return; // HÃ¡ um admin na sala.
  room.setPlayerAdmin(players[0].id, true); // DÃ¡ admin para o primeiro nÃ£o admin da sala.
}

room.onPlayerJoin = function(player) {
  updateAdmins();
}

let lastPlayersKicked = [null, null]

room.onPlayerBallKick = function(player) {
    if(!lastPlayersKicked[0]) lastPlayersKicked[0] = player

    if(lastPlayersKicked[0].id != player.id) {
        lastPlayersKicked[1] = lastPlayersKicked[0]
        lastPlayersKicked[0] = player
    }
}

room.onTeamGoal = function(team) {

    if(!lastPlayersKicked[0]) return false;

    if(team == lastPlayersKicked[0].team) {
        room.sendAnnouncement(`âš½ GOOOOOOLLL da Lenda ${lastPlayersKicked[0].name}`, null, 0x2BFF00, "small");
        
        if(lastPlayersKicked[1] && lastPlayersKicked[1].team == team && lastPlayersKicked[1].id != lastPlayersKicked[0].id) {   
            room.sendAnnouncement(`ğŸ© Passe do Maestro  ${lastPlayersKicked[1].name}`, null, 0x00B3FF, "small", 0);
        }
    }else{
        room.sendAnnouncement(`ğŸ¤£ Gol contra de ${lastPlayersKicked[0].name}`, null, 0xA875FF, "small");
    }

}

let afks = []

let officialAsd = []
let officialVip = []
let officialVipD = []
let officialJog = []
let officialDire = []

room.onPlayerChat = function (player, message) {
	if (message == "!0104" ) { // Senha para logar como admin.
		room.setPlayerAdmin(player.id, true); // DÃ¡ admin para o jogador que digitou a senha.
		room.sendChat(" ğŸ’ O á´˜ÊŸá´€Êá´‡Ê€ " + player.name + " ÊŸá´É¢á´á´œ á´„á´á´á´ PROPRIETÃRIO XirinÂ®!ğŸ‘‘ ");
		officialAsd.push(player.id)
        return false;
	}	
	if (message == "!admgeo" ) { // Senha para logar como admin.
		room.setPlayerAdmin(player.id, true); // DÃ¡ admin para o jogador que digitou a senha.
		room.sendChat(" ğŸ’ O á´˜ÊŸá´€Êá´‡Ê€ " + player.name + " ÊŸá´É¢á´á´œ Cá´á´ A Senha Do PROPRIETÃRIO Geozin ğŸ’ ");
		officialVipD.push(player.id)
        return false;
        }
        if (message == "!Hyper" ) { // Senha para logar como admin.
		room.setPlayerAdmin(player.id, true); // DÃ¡ admin para o jogador que digitou a senha.
		room.sendChat(" ğŸ® O á´˜ÊŸá´€Êá´‡Ê€ " + player.name + " ÊŸá´É¢á´á´œ á´„á´á´o CapitÃ£o á´Ò“Éªá´„Éªá´€ÊŸ da Hx âšªï¸âš« ");
		officialVip.push(player.id)
        return false;
	}
    if (message == "!ez" ) { // Senha para logar como admin.
		room.setPlayerAdmin(player.id, true); // DÃ¡ admin para o jogador que digitou a senha.
		room.sendChat(" ğŸ® O á´˜ÊŸá´€Êá´‡Ê€ " + player.name + " ÊŸá´É¢á´á´œ á´„á´á´á´ JOGADOR á´Ò“Éªá´„Éªá´€ÊŸ á´…á´€ Hx ğŸ® ");
		officialJog.push(player.id)
        return false;
        }
	if (message == "!limpar" && player.admin ) { // Comando para retirar os banimentos da sala.
		room.clearBans();
		room.sendChat( " Ná´€Ìƒá´ Êœá´€Ì á´á´€Éªs á´˜ÊŸá´€Êá´‡Ê€s Ê™á´€É´Éªá´…á´sï¹— ğŸ”« " );
        return false;
	}
	if (message == "!fechar" && player.admin ) { // Comando para definir uma senha para a sala.
		room.setPassword("hxhx"); // "sala" Ã© a nova senha da sala.
		room.sendChat( " A sá´€ÊŸá´€ Ò“á´Éª á´›Ê€á´€É´á´„á´€á´…á´€ á´„á´á´ sá´œá´„á´‡ssá´ï¹— ğŸ”’ " );
        return false;
	}
	if (message == "!abrir" && player.admin ){ // Comando para retirar senha da sala.
		room.setPassword(); // como nÃ£o hÃ¡ nada entre os parenteses a senha estÃ¡ em branco e isso Ã© igual a nÃ£o ter senha.
		room.sendChat(" A sá´€ÊŸá´€ Ò“á´Éª á´€Ê™á´‡Ê€á´›á´€ á´„á´á´ sá´œá´„á´‡ssá´ï¹— ğŸ”“ ");
        return false;
	}
    if (message == "!help" ) { // Senha para logar como admin.
		room.sendChat(" ğŸ”— Os á´„á´á´á´€É´á´…á´s á´€á´›á´œá´€Éªs sá´€Ìƒá´ï¹•  !afk, !helpadm ğŸ”— ");
		return false;
	}
    if (message == "!helpadm" ) { // Senha para logar como admin.
		room.sendChat(" ğŸ”° Os á´„á´á´á´€É´á´…á´s á´…á´‡ á´€á´…á´ÉªÉ´ sá´€Ìƒá´ï¹• ï¹—ÊŸÉªá´á´˜á´€Ê€ï¹ ï¹—Ò“á´‡á´„Êœá´€Ê€ï¹ ï¹—á´€Ê™Ê€ÉªÊ€. ");
		return false;
	}
    if (message == "!unis" ) { // Comando para retirar senha da sala.
		room.sendChat(" ğŸ‘• Os á´œÉ´Éªs sá´€Ìƒá´ï¹• ï¹—HXRï¹ ï¹—HXBï¹ ğŸ‘• ");
        return false;
	}
    if (message == "!HX1" && player.admin ){ // Comando para retirar senha da sala.
		room.sendChat("/colors red 60 FFFFFF 000000 000000 000000");
        return false;
    }
    if (message == "!HX2" && player.admin ){ // Comando para retirar senha da sala.
		room.sendChat("/colors blue 60 000000 FFFFFF FFFFFF FFFFFF");
        return false;
    }
    if (message == "!afk") {
        if (afks.includes(player.id)) {
                afks.splice(afks.indexOf(player.id), 1)
                room.sendAnnouncement(player.name + " nÃ£o estÃ¡ mais afk.", null)
            } else {
                afks.push(player.id)
                room.sendAnnouncement(player.name + " ficou afk.", null)
                if (player.team != 0) {
                    room.setPlayerTeam(player.id, 0);
                }
            }
        }
        
    if (message == "!spec_off" && player.admin) {
        specoff = true;
        room.sendChat(" Os spectadores foram silenciados. ğŸ”ˆ ");
    } 
    if (message == "!spec_on" && player.admin) {
        specoff = false;
        room.sendChat(" Os spectadores voltaram a falar ğŸ”Š ");
    }
    if (officialAsd.includes(player.id)) {
        room.sendAnnouncement("ğŸ‘‘âŒ " + player.name + ": " + message, null, 0x00FFDD);
        return false;
    }
    if (officialJog.includes(player.id)) {
        room.sendAnnouncement("ğŸ®âŒ " + player.name + ": " + message, null, 0xFF0000);
        return false;
    } 
    if (officialVipD.includes(player.id)) {
        room.sendAnnouncement("ğŸ’âŒ " + player.name + ": " + message, null, 0xFFFF00);
        return false;
    }
    if (officialVip.includes(player.id)) {
        room.sendAnnouncement("ğŸ’âŒ " + player.name + ": " + message, null, 0xFFFF00);
        return false;
    }
    if (specoff && !player.admin) return false;
}

room.onPlayerLeave = function(player) {
  updateAdmins();
}
room.onPlayerJoin = function(player) {
  room.sendAnnouncement("Bem vindo, " + player.name + "!", player.id);
  updateAdmins()
}

room.onPlayerTeamChange = function(changedPlayer) {
    if(afks.includes(changedPlayer.id)) {
        room.setPlayerTeam(changedPlayer.id, 0)
        room.sendAnnouncement(changedPlayer.name + " estÃ¡ afk.", null)
    }
}